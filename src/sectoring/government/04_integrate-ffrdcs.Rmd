---
title: "Untitled"
output: html_document
---

```{r setup, include=FALSE}

rm(list = ls())
# install.packages(c("tidyverse", "igraph", "visNetwork", "bc3net", "data.table", "R.utils", "RPostgreSQL", "cowplot", "maditr"))

# load packages 
for (pkg in c("tidyverse", "igraph", "data.table", "R.utils", "countrycode", 
              "RPostgreSQL", "cowplot", "maditr")) {library(pkg, character.only = TRUE)}

# load local functions 
#source("/sfs/qumulo/qhome/kb7hp/oss-2020/functions/standardization-functions.R")

# PULL AZ-INDEX, GOV MANUAL AND LIST OF FFRDCS FROM POSTGRESQL 

# connect to postgresql to get our data
conn <- dbConnect(drv = PostgreSQL(), 
                  dbname = "sdad", 
                  host = "10.250.124.195", 
                  port = 5432, 
                  user = Sys.getenv("db_userid"), 
                  password = Sys.getenv("db_pwd"))

# query the users_gh data (table of all github users) 
usgov_ffrdcs <- dbGetQuery(conn, "SELECT * FROM us_gov_depts.us_gov_ffrdcs")

# disconnect from postgresql database 
dbDisconnect(conn)

usgov_az_man <- read_csv("/sfs/qumulo/qhome/kb7hp/oss-2020/data/usgov_az_man.csv") 


```

```{r}
# load local functions 
source("/sfs/qumulo/qhome/kb7hp/oss-2020/functions/standardize_gov.R")

usgov_ffrdcs %>% 
  rename(institution = FFRDC_Name, agency = Agency, subagency = Sub_Agency) %>% 
  select(agency, subagency, institution) %>% 
  standardize_gov()



```
